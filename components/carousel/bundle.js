(()=>{"use strict";const e=new RegExp("^s+|s+$","g"),t=["input","textarea"];function r(e){return t.indexOf(e.tagName.toLowerCase())>-1}window.GUIComponentsDefinedElements={},window.GUIComponentsDefinedElements||(window.GUIComponentsDefinedElements={});class i extends HTMLElement{get instanceType(){return"BaseComponent"}setupTemplate(e,t){if(!this.isConnected)return console.log(`DEBUG: component ${this.tagName} was not initialized because it was disconnected from the DOM!`);this.template=e.template,t(e.template)}isStatePropValid(e,t){const r=this.stateSchema[e];if(!r)return console.error(`A property ${e} does not exist on type ${this.tagName.toLowerCase()}!`),!1;const i=typeof t;return!(!r.type.includes("array")||!Array.isArray(t))||(!!r.type.includes(i)||(console.error(`Property ${e} can not be of type - ${i}. Allowed types are: ${r.type.join(",")}`),!1))}}class s{get instanceType(){return"Validator"}static isFormElement(e){for(e=e.parentElement;e;){if("GAMEFACE-FORM-CONTROL"===e.tagName||"gameface-form-control"===e.tagName)return!0;e=e.parentElement}return!1}static tooLong(){return!1}static tooShort(){return!1}static rangeOverflow(){return!1}static rangeUnderflow(){return!1}static valueMissing(e){return e.hasAttribute("required")&&!e.value}static nameMissing(e){return!e.name&&!e.getAttribute("name")}static isRequired(e){return e.hasAttribute("required")}static customError(){return!1}static willSerialize(e){return!this.nameMissing(e)}static isBadURL(){return!1}static isBadEmail(){return!1}}class n{get instanceType(){return"NativeElementValidator"}constructor(e){this.element=e}isFormElement(){return s.isFormElement(this.element)}tooLong(){return r(this.element)?a.tooLong(this.element):s.tooLong()}tooShort(){return r(this.element)?a.tooShort(this.element):s.tooShort()}rangeOverflow(){return r(this.element)?a.rangeOverflow(this.element):s.rangeOverflow()}rangeUnderflow(){return r(this.element)?a.rangeUnderflow(this.element):s.rangeUnderflow()}valueMissing(){return s.valueMissing(this.element)}nameMissing(){return s.nameMissing(this.element)}customError(){return s.customError()}isRequired(){return s.isRequired(this.element)}willSerialize(){return s.willSerialize(this.element)}isBadEmail(){return!!r(this.element)&&a.isBadEmail(this.element)}isBadURL(){return!!r(this.element)&&a.isBadURL(this.element)}}class o extends i{get instanceType(){return"CustomElementValidator"}isFormElement(){return s.isFormElement(this)}tooLong(){return s.tooLong(this)}tooShort(){return s.tooShort(this)}valueMissing(){return s.valueMissing(this)}nameMissing(){return s.nameMissing(this)}customError(){return s.customError()}isRequired(){return s.isRequired(this)}rangeOverflow(){return s.rangeOverflow(this)}rangeUnderflow(){return s.rangeUnderflow(this)}willSerialize(){return s.willSerialize(this)}isBadEmail(){return s.isBadEmail(this)}isBadURL(){return s.isBadURL(this)}}class a{get instanceType(){return"TextFieldValidator"}static tooLong(e){const t=e.getAttribute("maxlength");return!!t&&e.value.length>parseFloat(t)}static tooShort(e){const t=e.getAttribute("minlength");return!!t&&e.value.length<parseFloat(t)}static rangeOverflow(e){const t=e.getAttribute("max");return!!t&&parseFloat(e.value)>parseFloat(t)}static rangeUnderflow(e){const t=e.getAttribute("min");return!!t&&parseFloat(e.value)<parseFloat(t)}static isBadURL(e){if("url"!==e.getAttribute("type"))return!1;const t=e.pattern||e.getAttribute("pattern");return!!t&&!e.value.match(t)}static isBadEmail(e){return"email"===e.getAttribute("type")&&!e.value.match("@")}}const l=new function(){const t="component-slot",r={DOWN:40,LEFT:37,RIGHT:39,UP:38,HOME:36,END:35,ENTER:13,ESCAPE:27,TAB:9,SHIFT:16,CTRL:17,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,LETTER_A:65},l=new class{constructor(){this.imported=this.imported||[],this.KEYCODES=r,this.cachedComponents={},this.CustomElementValidator=o,this.NativeElementValidator=n,this.TextFieldValidator=a,this.Validator=s,this.BaseComponent=i}importScript(e){const t=document.createElement("script");t.setAttribute("src",e),document.body.appendChild(t)}loadHTML(e){return this.loadResource(e).then((e=>e.template))}whenDefined(e){if(void 0!==window.GUIComponentsDefinedElements[e])return window.GUIComponentsDefinedElements[e].promise;const t=window.GUIComponentsDefinedElements[e]={};return t.promise=new Promise(((e,r)=>{t.resolve=e,t.reject=r})),t.promise}defineCustomElement(e,t){window.GUIComponentsDefinedElements[e]||customElements.get(e)||(this.whenDefined(e),customElements.define(e,t),window.GUIComponentsDefinedElements[e].resolve(t))}importComponent(e){requestAnimationFrame((()=>{this.importScript(e+"/script.js")}))}removeSlashes(e){return e.replace(/[/|\\]/g,"")}removeNewLines(t){return t.replace(e,"").trim()}removeCopyrightNotice(e){return e.replace("\x3c!--Copyright (c) Coherent Labs AD. All rights reserved. Licensed under the MIT License. See License.txt in the project root for license information. --\x3e","").trim()}resolveWithTemplate(e){return new Promise((t=>{t({template:e.template,url:e.url})}))}loadResource(e){if(e.template&&"string"==typeof e.template){if(e.isRendered)return this.resolveWithTemplate(e);const t=this.removeCopyrightNotice(e.template);return new Promise((r=>{r({template:this.removeNewLines(t),url:e.url})}))}if("object"==typeof e.template&&e.isRendered)return this.resolveWithTemplate(e);if(window.__optimize){const t=this.removeSlashes(e.url),r=document.getElementById(t).firstChild;return r?new Promise((t=>{t({template:r.innerHTML,url:e.url})})):this.requestResource(e.url)}return this.requestResource(e.url)}requestResource(e){const t=new XMLHttpRequest,r=new Promise((function(r,i){t.onload=s=>{200==t.status?r({template:t.responseText,url:e}):i(s)},t.onerror=i}));return t.open("GET",e),t.send(),r}findSlots(e,r,i={}){const s=e.children,n=s.length;for(let e=0;e<n;++e){const n=s[e],o=n.tagName.toLowerCase();if("component-slot"===o){const e=n.dataset.name;i[e]||(i[e]=[]),i[e].push(n),this.findSlots(n,r,i)}else if(n.hasAttribute("slot")){const e=n.getAttribute("slot");i[e]||(i[e]=[]),i[e].push(n),this.findSlots(n,r,i)}else("gameface-scrollable-container"===o||o!==t&&r!==o&&!window.GUIComponentsDefinedElements[o])&&this.findSlots(n,r,i)}return i}replaceSlots(e,t){const r=t[0];if(e.length&&r.childNodes.length)for(;r.firstChild;)r.removeChild(r.lastChild);const i=r.parentNode;i.removeChild(r);for(let t=0;t<e.length;++t)i.appendChild(e[t])}transferContent(e,t){for(;t.childNodes.length>0;){const e=t.childNodes;t.removeChild(e[e.length-1])}for(;e.childNodes.length>0;){const r=e.childNodes[0];e.removeChild(r),t.appendChild(r)}}renderOnce(e){return!e.isRendered&&(this.render(e),e.isRendered=!0,!0)}render(e){const t=document.createElement("div");t.innerHTML=e.template;const r=e.tagName.toLowerCase(),i=this.findSlots(t,r),s=this.findSlots(e,r),n=Object.keys(s);if(Object.keys(i).length)for(const e of n)s[e]&&i[e]&&this.replaceSlots(s[e],i[e]);this.transferContent(t,e)}transferChildren(e,t,r){const i=document.createElement("div");i.innerHTML=e.template;const s=i.querySelector(t);r.forEach((e=>s.appendChild(e))),this.transferContent(i,e)}waitForFrames(e=(()=>{}),t=3){if(0===t)return e();t--,requestAnimationFrame((()=>this.waitForFrames(e,t)))}isBrowserGameface(){return navigator.userAgent.match("Cohtml")}};class h extends HTMLElement{constructor(){super(),this.originalAppendChild=this.appendChild,this.originalInsertBefore=this.insertBefore,this.originalReplaceChild=this.replaceChild,this.originalRemoveChild=this.removeChild,this.appendChild=e=>{const t=this.originalAppendChild(e);return this.disptachSlotChange(t),t},this.insertBefore=(e,t)=>{const r=this.originalInsertBefore(e,t);return this.disptachSlotChange(r),r},this.replaceChild=(e,t)=>{const r=this.originalReplaceChild(e,t);return this.disptachSlotChange(r),r},this.removeChild=e=>{const t=this.originalRemoveChild(e);return this.disptachSlotChange(t),t}}disptachSlotChange(e){this.dispatchEvent(new CustomEvent("slotchange"),{target:this,child:e})}}return l.defineCustomElement(t,h),l},h=l.BaseComponent,c=".guic-carousel-content-wrapper",u=".guic-carousel";l.defineCustomElement("gameface-carousel",class extends h{constructor(){super(),this.template='<div> <div class="guic-carousel"> <div class="guic-carousel-content-wrapper"> <component-slot data-name="carousel-content"></component-slot> </div> <div class="guic-carousel-btn-next guic-carousel-arrow guic-carousel-right-arrow"> <component-slot data-name="carousel-next" class="guic-carousel-arrow-slot"> <div class="guic-carousel-inner-arrow guic-carousel-inner-arrow-right"></div> </component-slot> </div> <div class="guic-carousel-btn-prev guic-carousel-arrow guic-carousel-left-arrow"> <component-slot data-name="carousel-previous" class="guic-carousel-arrow-slot"> <div class="guic-carousel-inner-arrow guic-carousel-inner-arrow-left"></div> </component-slot> </div> </div> <div class="guic-carousel-dots"></div> </div>',this.init=this.init.bind(this),this._pageSize=2,this._navArrowStepSize=1,this.currentItemIndex=0,this.itemsDirection=1}connectedCallback(){l.loadResource(this).then(this.init).catch((e=>console.error(e)))}init(e){this.setupTemplate(e,(()=>{l.renderOnce(this),this.contentWrapper=this.querySelector(c),l.waitForFrames((()=>{if(!this.items||!this.items[0])return console.warn("No items were added to the carousel!");const{width:e,height:t}=this.items[0].getBoundingClientRect();this.itemWidth=e,this.itemHeight=t,this.resize()})),this.style.visibility="visible",this.createPaginationControls(),this.attachControlButtonsListeners(),this.shouldShowNavArrow(1,this.nextStepIndex(this.navArrowStepSize)),this.shouldShowNavArrow(-1,this.prevStepIndex(this.navArrowStepSize))}))}get pages(){return this.items?.length/this.pageSize||0}get items(){return this.querySelector(c).children}get itemsLength(){return this.items.length}get visibleItemsIndexes(){return Array.from({length:this.pageSize},((e,t)=>t+this.currentItemIndex))}get visibleItems(){const e=this.items;return this.visibleItemsIndexes.map((t=>e[t]))}get leftArrow(){return document.querySelector(".guic-carousel-left-arrow")}get rightArrow(){return document.querySelector(".guic-carousel-right-arrow")}get navArrowStepSize(){return this._navArrowStepSize}set navArrowStepSize(e){this._navArrowStepSize=e}get currentItemIndex(){return this._currentItemIndex}set currentItemIndex(e){this._currentItemIndex=e}get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=e,this.resize(),this.createPaginationControls()}hideArrow(e){if(1===e)return this.rightArrow.classList.add("guic-carousel-hidden");this.leftArrow.classList.add("guic-carousel-hidden")}showArrow(e){if(1===e)return this.rightArrow.classList.remove("guic-carousel-hidden");this.leftArrow.classList.remove("guic-carousel-hidden")}overflows(e){return this.itemsLength-e<this.pageSize}nextStepIndex(e){return(this.currentItemIndex+e)%this.items.length}prevStepIndex(e){const t=this.items.length;return(this.currentItemIndex-e+t)%t}shouldShowNavArrow(e,t){if(this.overflows(t))return this.hideArrow(e);this.showArrow(e)}addItem(e,t){const r=this.querySelector(c);if(void 0===t||t<0)r.appendChild(e);else{const r=this.items[t-1];r.parentNode.insertBefore(e,r)}this.createPaginationControls()}removeItem(e=0){const t=this.items;Array.from(t)[e].remove(),this.createPaginationControls()}previous(e){const t=this.items.length;let r=(this.currentItemIndex-e+t)%t;this.overflows(r)&&(r=0),this.currentItemIndex=r,this.moveTo(-this.currentItemIndex),this.shouldShowNavArrow(-1,this.prevStepIndex(this.navArrowStepSize)),this.shouldShowNavArrow(1,this.nextStepIndex(this.navArrowStepSize))}next(e){const t=(this.currentItemIndex+e)%this.items.length;this.overflows(t)||(this.currentItemIndex=t,this.moveTo(-this.currentItemIndex)),this.shouldShowNavArrow(-1,this.prevStepIndex(this.navArrowStepSize)),this.shouldShowNavArrow(1,this.nextStepIndex(this.navArrowStepSize))}moveTo(e){this.contentWrapper.style.left=e*this.itemWidth+"px"}createDot(e){const t=document.createElement("div");return t.classList.add("guic-carousel-dot"),t.dataset.page=e,t}createPaginationControls(){const e=this.querySelector(".guic-carousel-dots");e.innerHTML="";for(let t=0;t<this.pages;t++)e.appendChild(this.createDot(t));const t=e.querySelectorAll(".guic-carousel-dot");for(let e=0;e<t.length;e++)t[e].addEventListener("click",(e=>this.onClickOnNavDot(e)))}onClickOnNavDot(e){const t=e.currentTarget.dataset.page;this.currentItemIndex=Number(t)*this.pageSize,this.moveTo(-this.currentItemIndex),this.shouldShowNavArrow(1,this.nextStepIndex(this.navArrowStepSize)),this.shouldShowNavArrow(-1,this.prevStepIndex(this.navArrowStepSize))}resize(){this.querySelector(u).style.width=this.pageSize*this.itemWidth+"px",this.querySelector(u).style.height=this.itemHeight+"px",this.style.width=this.pageSize*this.itemWidth+"px"}attachControlButtonsListeners(){const e=this.querySelector(".guic-carousel-btn-next"),t=this.querySelector(".guic-carousel-btn-prev");e.addEventListener("click",(e=>this.next(1))),t.addEventListener("click",(e=>this.previous(1)))}})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUtoSCxHQUFHa0gsaUJBQWlCLFNBQVNDLEdBQUt4TyxLQUFLeU8sZ0JBQWdCRCxJQUVwRSxDQU9BLGVBQUFDLENBQWdCRCxHQUNaLE1BQU1MLEVBQU9LLEVBQUVFLGNBQWNsSCxRQUFRMkcsS0FDckNuTyxLQUFLZ0wsaUJBQW9CMkQsT0FBT1IsR0FBUW5PLEtBQUt1TSxTQUU3Q3ZNLEtBQUtnTyxRQUFRaE8sS0FBS2dMLGtCQUNsQmhMLEtBQUtrTSxtQkFsVUYsRUFrVXVDbE0sS0FBS21NLGNBQWNuTSxLQUFLb00sbUJBQ2xFcE0sS0FBS2tNLG9CQXBVSCxFQW9VdUNsTSxLQUFLcU0sY0FBY3JNLEtBQUtvTSxrQkFDckUsQ0FLQSxNQUFBUCxHQUNJN0wsS0FBS2tKLGNBQWN5QixHQUFtQm1CLE1BQU1OLE1BQVF4TCxLQUFLdU0sU0FBV3ZNLEtBQUsyTCxVQUFZLEtBQ3JGM0wsS0FBS2tKLGNBQWN5QixHQUFtQm1CLE1BQU1MLE9BQVN6TCxLQUFLNEwsV0FBYSxLQUN2RTVMLEtBQUs4TCxNQUFNTixNQUFReEwsS0FBS3VNLFNBQVd2TSxLQUFLMkwsVUFBWSxJQUN4RCxDQUtBLDZCQUFBTSxHQUNJLE1BQU0yQyxFQUFtQjVPLEtBQUtrSixjQTFWWiwyQkEyVloyRixFQUF1QjdPLEtBQUtrSixjQTFWaEIsMkJBNFZsQjBGLEVBQWlCTCxpQkFBaUIsU0FBUzVCLEdBQUszTSxLQUFLeU4sS0FBSyxLQUMxRG9CLEVBQXFCTixpQkFBaUIsU0FBUzVCLEdBQUszTSxLQUFLK04sU0FBUyxJQUN0RSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29oZXJlbnQtZ2FtZWZhY2UtY2Fyb3VzZWwvLi4vLi4vbGliL2NvbXBvbmVudHMuanMiLCJ3ZWJwYWNrOi8vY29oZXJlbnQtZ2FtZWZhY2UtY2Fyb3VzZWwvLi90ZW1wbGF0ZS5odG1sIiwid2VicGFjazovL2NvaGVyZW50LWdhbWVmYWNlLWNhcm91c2VsLy4vc2NyaXB0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqICBDb3B5cmlnaHQgKGMpIENvaGVyZW50IExhYnMgQUQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxyXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuLyogZXNsaW50LWRpc2FibGUgbm8tdXNlbGVzcy1lc2NhcGUgKi9cclxuY29uc3QgbmV3TGluZXNSZWdFeHAgPSBuZXcgUmVnRXhwKCdeXFxzK3xcXHMrJCcsICdnJyk7XHJcbmNvbnN0IE5BVElWRV9URVhUX0ZJRUxEX0VMRU1FTlRTID0gWydpbnB1dCcsICd0ZXh0YXJlYSddO1xyXG53aW5kb3cuR1VJQ29tcG9uZW50c0RlZmluZWRFbGVtZW50cyA9IHt9O1xyXG5cclxuaWYgKCF3aW5kb3cuR1VJQ29tcG9uZW50c0RlZmluZWRFbGVtZW50cykgd2luZG93LkdVSUNvbXBvbmVudHNEZWZpbmVkRWxlbWVudHMgPSB7fTtcclxuXHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIHRoZSBwYXNzZWQgZWxlbWVudCBpcyBhIG5hdGl2ZSB0ZXh0IGZpZWxkXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAqL1xyXG5mdW5jdGlvbiBpc05hdGl2ZVRleHRGaWVsZChlbGVtZW50KSB7XHJcbiAgICByZXR1cm4gTkFUSVZFX1RFWFRfRklFTERfRUxFTUVOVFMuaW5kZXhPZihlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgPiAtMTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEJhc2VDb21wb25lbnRcclxuICogVGhlIGJhc2UgY2xhc3MgZnJvbSB3aGljaCBhbGwgb3RoZXIgY29tcG9uZW50cyBpbmhlcml0IHNoYXJlZCBsb2dpY1xyXG4gKi9cclxuY2xhc3MgQmFzZUNvbXBvbmVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHRoZSB0eXBlIG9mIHRoZSBjbGFzc1xyXG4gICAgICovXHJcbiAgICBnZXQgaW5zdGFuY2VUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiAnQmFzZUNvbXBvbmVudCc7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSB0ZW1wbGF0ZSBvZiBhIGNvbXBvbmVudCB3YXMgbG9hZGVkLlxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGRhdGFcclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrXHJcbiAgICAgKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxyXG4gICAgKi9cclxuICAgIHNldHVwVGVtcGxhdGUoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNDb25uZWN0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGBERUJVRzogY29tcG9uZW50ICR7dGhpcy50YWdOYW1lfSB3YXMgbm90IGluaXRpYWxpemVkIGJlY2F1c2UgaXQgd2FzIGRpc2Nvbm5lY3RlZCBmcm9tIHRoZSBET00hYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRlbXBsYXRlID0gZGF0YS50ZW1wbGF0ZTtcclxuICAgICAgICBjYWxsYmFjayhkYXRhLnRlbXBsYXRlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGUgaWYgYSB2YWx1ZSBjYW4gYmUgc2V0IG9uIHRoZSBzdGF0ZS5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gdGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5LlxyXG4gICAgICogQHBhcmFtIHthbnl9IHZhbHVlIC0gdGhlIHZhbHVlIHRoYXQgaGFzIHRvIGJlIGNoZWNrZWQuXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgaXNTdGF0ZVByb3BWYWxpZChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IHNjaGVtYVByb3BlcnR5ID0gdGhpcy5zdGF0ZVNjaGVtYVtuYW1lXTtcclxuXHJcbiAgICAgICAgaWYgKCFzY2hlbWFQcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBBIHByb3BlcnR5ICR7bmFtZX0gZG9lcyBub3QgZXhpc3Qgb24gdHlwZSAke3RoaXMudGFnTmFtZS50b0xvd2VyQ2FzZSgpfSFgKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcclxuICAgICAgICBpZiAoc2NoZW1hUHJvcGVydHkudHlwZS5pbmNsdWRlcygnYXJyYXknKSkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChpc0FycmF5KSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghc2NoZW1hUHJvcGVydHkudHlwZS5pbmNsdWRlcyh0eXBlKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBQcm9wZXJ0eSAke25hbWV9IGNhbiBub3QgYmUgb2YgdHlwZSAtICR7dHlwZX0uIEFsbG93ZWQgdHlwZXMgYXJlOiAke3NjaGVtYVByb3BlcnR5LnR5cGUuam9pbignLCcpfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgaXMgdGhlIGJhc2UgY2xhc3MgdGhhdCBob2xkcyBhbGwgZnVuY3Rpb25hbGl0eSBzaGFyZWQgYmV0d2VlbiBjdXN0b20gY29tcG9uZW50c1xyXG4gKiBhbmQgbmF0aXZlIGVsZW1lbnRzXHJcbiAqL1xyXG5jbGFzcyBWYWxpZGF0b3Ige1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGhlIHR5cGUgb2YgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGdldCBpbnN0YW5jZVR5cGUoKSB7XHJcbiAgICAgICAgcmV0dXJuICdWYWxpZGF0b3InO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgZWxlbWVudCBpcyBjaGlsZCBvZiBhIGZvcm1cclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgaXNGb3JtRWxlbWVudChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICB3aGlsZSAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC50YWdOYW1lID09PSAnR0FNRUZBQ0UtRk9STS1DT05UUk9MJyB8fCBlbGVtZW50LnRhZ05hbWUgPT09ICdnYW1lZmFjZS1mb3JtLWNvbnRyb2wnKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGVsZW1lbnQgdmFsdWUgaXMgYmlnZ2VyIHRoYW4gZWxlbWVudCBtYXhsZW5ndGhcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgdG9vTG9uZygpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBlbGVtZW50IHZhbHVlIGlzIGxlc3MgdGhhbiBlbGVtZW50IG1pbmxlbmd0aFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyB0b29TaG9ydCgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIHZhbHVlIG9mIGFuIGVsZW1lbnQgaXMgYmlnZ2VyIHRoYW4gaXRzIG1heCBhdHRyaWJ1dGVcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgKi9cclxuICAgIHN0YXRpYyByYW5nZU92ZXJmbG93KCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiB0aGUgdmFsdWUgb2YgYW4gZWxlbWVudCBpcyBzbWFsbGVyIHRoYW4gaXRzIG1pbiBhdHRyaWJ1dGVcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgKi9cclxuICAgIHN0YXRpYyByYW5nZVVuZGVyZmxvdygpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBlbGVtZW50IGlzIHJlcXVpcmVkIGFuZCBpdHMgdmFsdWUgaXMgbWlzc2luZ1xyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyB2YWx1ZU1pc3NpbmcoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50Lmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKSAmJiAhZWxlbWVudC52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGVsZW1lbnQgbmFtZSBpcyBtaXNzaW5nXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIG5hbWVNaXNzaW5nKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gIWVsZW1lbnQubmFtZSAmJiAhZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGFuIGVsZW1lbnQgaXMgcmVxdWlyZWRcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgKi9cclxuICAgIHN0YXRpYyBpc1JlcXVpcmVkKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3JlcXVpcmVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlcmUgaXMgYSBjdXN0b20gZXJyb3IgZm9yIHRoZSBlbGVtZW50XHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGN1c3RvbUVycm9yKCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiBlbGVtZW50IGlzIGdvaW5nIHRvIGJlIHNlcmlhbGl6ZWQuXHJcbiAgICAgKiBJZiBhbiBlbGVtZW50IGRvZXNuJ3QgaGF2ZSBhIG5hbWUgaXQgd2lsbCBub3QgYmUgc2VyaWFsaXplZC5cclxuICAgICAqIFVzZWQgdG8gZGV0ZXJtaW5lIGlmIGFuIGVsZW1lbnQgc2hvdWxkIGJlIHZhbGlkYXRlZC5cclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgKi9cclxuICAgIHN0YXRpYyB3aWxsU2VyaWFsaXplKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYW1lTWlzc2luZyhlbGVtZW50KSA/IGZhbHNlIDogdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKiBlc2xpbnQtZGlzYWJsZSByZXF1aXJlLWpzZG9jICovXHJcbiAgICBzdGF0aWMgaXNCYWRVUkwoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBpc0JhZEVtYWlsKCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8qIGVzbGludC1lbmFibGUgcmVxdWlyZS1qc2RvYyAqL1xyXG59XHJcblxyXG4vKipcclxuICogVGhlIE5hdGl2ZUVsZW1lbnRWYWxpZGF0b3IgdXNlcyB0aGUgbWV0aG9kcyBmcm9tIHRoZSBWYWxpZGF0b3IgY2xhc3NcclxuICogQWxsIG5hdGl2ZSBlbGVtZW50cyB0aGEgZG9uJ3Qgc3VwcG9ydCBtZXRob2RzIGxpa2UgaXNGb3JtRWxlbWVudCwgdG9vTG9uZywgdG9vU2hvcnRcclxuICogZXRjLi4gd2lsbCBiZSB3cmFwcGVkIGluIHRoaXMgY2xhc3MgaW4gb3JkZXIgdG8gZW5hYmxlIHVzIHRvIHZhbGlkYXRlIG5hdGl2ZSBhbmRcclxuICogY3VzdG9tIGVsZW1lbnRzIHVzaW5nIHRoZSBzYW1lIG1ldGhvZHMuXHJcbiAqICovXHJcbmNsYXNzIE5hdGl2ZUVsZW1lbnRWYWxpZGF0b3Ige1xyXG4gICAgLyogZXNsaW50LWRpc2FibGUgcmVxdWlyZS1qc2RvYyAqL1xyXG4gICAgZ2V0IGluc3RhbmNlVHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gJ05hdGl2ZUVsZW1lbnRWYWxpZGF0b3InO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGlzRm9ybUVsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5pc0Zvcm1FbGVtZW50KHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9vTG9uZygpIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVUZXh0RmllbGQodGhpcy5lbGVtZW50KSkgcmV0dXJuIFRleHRGaWVsZFZhbGlkYXRvci50b29Mb25nKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci50b29Mb25nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9vU2hvcnQoKSB7XHJcbiAgICAgICAgaWYgKGlzTmF0aXZlVGV4dEZpZWxkKHRoaXMuZWxlbWVudCkpIHJldHVybiBUZXh0RmllbGRWYWxpZGF0b3IudG9vU2hvcnQodGhpcy5lbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gVmFsaWRhdG9yLnRvb1Nob3J0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmFuZ2VPdmVyZmxvdygpIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVUZXh0RmllbGQodGhpcy5lbGVtZW50KSkgcmV0dXJuIFRleHRGaWVsZFZhbGlkYXRvci5yYW5nZU92ZXJmbG93KHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5yYW5nZU92ZXJmbG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmFuZ2VVbmRlcmZsb3coKSB7XHJcbiAgICAgICAgaWYgKGlzTmF0aXZlVGV4dEZpZWxkKHRoaXMuZWxlbWVudCkpIHJldHVybiBUZXh0RmllbGRWYWxpZGF0b3IucmFuZ2VVbmRlcmZsb3codGhpcy5lbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gVmFsaWRhdG9yLnJhbmdlVW5kZXJmbG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFsdWVNaXNzaW5nKCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IudmFsdWVNaXNzaW5nKHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmFtZU1pc3NpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5uYW1lTWlzc2luZyh0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGN1c3RvbUVycm9yKCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IuY3VzdG9tRXJyb3IoKTtcclxuICAgIH1cclxuXHJcbiAgICBpc1JlcXVpcmVkKCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IuaXNSZXF1aXJlZCh0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHdpbGxTZXJpYWxpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci53aWxsU2VyaWFsaXplKHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNCYWRFbWFpbCgpIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVUZXh0RmllbGQodGhpcy5lbGVtZW50KSkgcmV0dXJuIFRleHRGaWVsZFZhbGlkYXRvci5pc0JhZEVtYWlsKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlzQmFkVVJMKCkge1xyXG4gICAgICAgIGlmIChpc05hdGl2ZVRleHRGaWVsZCh0aGlzLmVsZW1lbnQpKSByZXR1cm4gVGV4dEZpZWxkVmFsaWRhdG9yLmlzQmFkVVJMKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyogZXNsaW50LWVuYWJsZSByZXF1aXJlLWpzZG9jICovXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgQ3VzdG9tRWxlbWVudFZhbGlkYXRvciBpcyBpbmhlcml0ZWQgYnkgY3VzdG9tIGVsZW1lbnRzIGluIG9yZGVyIHRvIGdhaW4gdGhlXHJcbiAqIHZhbGlkYXRpb24gZnVuY3Rpb24gZnJvbSB0aGUgVmFsaWRhdG9yIGNsYXNzLlxyXG4gKiBUaGlzIGNsYXNzIGNhbiBub3QgYmUgdXNlZCB0byB3cmFwIHRoZSBuYXRpdmUgZWxlbWVudHMgYXMgaXQgaW5oZXJpdHMgdGhlXHJcbiAqIEhUTUxFbGVtZW50IHdoaWNoIGNhbiBub3QgYmUgaW5zdGFudGlhdGVkIHVzaW5nIHRoZSBuZXcga2V5d29yZC5cclxuKi9cclxuY2xhc3MgQ3VzdG9tRWxlbWVudFZhbGlkYXRvciBleHRlbmRzIEJhc2VDb21wb25lbnQge1xyXG4gICAgLyogZXNsaW50LWRpc2FibGUgcmVxdWlyZS1qc2RvYyAqL1xyXG4gICAgZ2V0IGluc3RhbmNlVHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gJ0N1c3RvbUVsZW1lbnRWYWxpZGF0b3InO1xyXG4gICAgfVxyXG5cclxuICAgIGlzRm9ybUVsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5pc0Zvcm1FbGVtZW50KHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvb0xvbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci50b29Mb25nKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvb1Nob3J0KCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IudG9vU2hvcnQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFsdWVNaXNzaW5nKCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IudmFsdWVNaXNzaW5nKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG5hbWVNaXNzaW5nKCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IubmFtZU1pc3NpbmcodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgY3VzdG9tRXJyb3IoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5jdXN0b21FcnJvcigpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzUmVxdWlyZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5pc1JlcXVpcmVkKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJhbmdlT3ZlcmZsb3coKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5yYW5nZU92ZXJmbG93KHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJhbmdlVW5kZXJmbG93KCkge1xyXG4gICAgICAgIHJldHVybiBWYWxpZGF0b3IucmFuZ2VVbmRlcmZsb3codGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgd2lsbFNlcmlhbGl6ZSgpIHtcclxuICAgICAgICByZXR1cm4gVmFsaWRhdG9yLndpbGxTZXJpYWxpemUodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNCYWRFbWFpbCgpIHtcclxuICAgICAgICByZXR1cm4gVmFsaWRhdG9yLmlzQmFkRW1haWwodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNCYWRVUkwoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRvci5pc0JhZFVSTCh0aGlzKTtcclxuICAgIH1cclxuICAgIC8qIGVzbGludC1lbmFibGUgcmVxdWlyZS1qc2RvYyAqL1xyXG59XHJcblxyXG4vKipcclxuICogQ2xhc3MgdGhhdCBpbXBsZW1lbnRzIHRoZSBjb21tb25nIHZhbGlkYXRpb24gbWV0aG9kcyBmb3IgdGhlIHRleHQgZmllbGRzXHJcbiAqL1xyXG5jbGFzcyBUZXh0RmllbGRWYWxpZGF0b3Ige1xyXG4gICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlcXVpcmUtanNkb2MgKi9cclxuICAgIGdldCBpbnN0YW5jZVR5cGUoKSB7XHJcbiAgICAgICAgcmV0dXJuICdUZXh0RmllbGRWYWxpZGF0b3InO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTW9zdCBvZiB0aGUgY3VzdG9tIGVsZW1lbnRzIHdpbGwgbm90IG5lZWQgdGhpcyBjaGVjayBob3dldmVyLFxyXG4gICAgICogd2UgY2FsbCBhbGwgdmFsaWRhdGlvbiBtZXRob2RzIGluIG9yZGVyIHRvIGRldGVybWluZSBpZiBhbiBlbGVtZW50IGlzIHZhbGlkLlxyXG4gICAgICogRWFjaCBlbGVtZW50IHRoYXQgbmVlZHMgdGhpcyBjaGVjayBpbXBsZW1lbnRzIGl0IGl0c2VsZi5cclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgdG9vTG9uZyhlbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xyXG4gICAgICAgIGlmICghbWF4TGVuZ3RoKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQudmFsdWUubGVuZ3RoID4gcGFyc2VGbG9hdChtYXhMZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBNb3N0IG9mIHRoZSBjdXN0b20gZWxlbWVudHMgd2lsbCBub3QgbmVlZCB0aGlzIGNoZWNrIGhvd2V2ZXIsXHJcbiAgICAqIHdlIGNhbGwgYWxsIHZhbGlkYXRpb24gbWV0aG9kcyBpbiBvcmRlciB0byBkZXRlcm1pbmUgaWYgYW4gZWxlbWVudCBpcyB2YWxpZC5cclxuICAgICogRWFjaCBlbGVtZW50IHRoYXQgbmVlZHMgdGhpcyBjaGVjayBpbXBsZW1lbnRzIGl0IGl0c2VsZi5cclxuICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudFxyXG4gICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICovXHJcbiAgICBzdGF0aWMgdG9vU2hvcnQoZWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IG1pbkxlbmd0aCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdtaW5sZW5ndGgnKTtcclxuICAgICAgICBpZiAoIW1pbkxlbmd0aCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LnZhbHVlLmxlbmd0aCA8IHBhcnNlRmxvYXQobWluTGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogTW9zdCBvZiB0aGUgY3VzdG9tIGVsZW1lbnRzIHdpbGwgbm90IG5lZWQgdGhpcyBjaGVjayBob3dldmVyLFxyXG4gICAgKiB3ZSBjYWxsIGFsbCB2YWxpZGF0aW9uIG1ldGhvZHMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIGlmIGFuIGVsZW1lbnQgaXMgdmFsaWQuXHJcbiAgICAqIEVhY2ggZWxlbWVudCB0aGF0IG5lZWRzIHRoaXMgY2hlY2sgaW1wbGVtZW50cyBpdCBpdHNlbGYuXHJcbiAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAqL1xyXG4gICAgc3RhdGljIHJhbmdlT3ZlcmZsb3coZWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IG1heCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdtYXgnKTtcclxuICAgICAgICBpZiAoIW1heCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGVsZW1lbnQudmFsdWUpID4gcGFyc2VGbG9hdChtYXgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTW9zdCBvZiB0aGUgY3VzdG9tIGVsZW1lbnRzIHdpbGwgbm90IG5lZWQgdGhpcyBjaGVjayBob3dldmVyLFxyXG4gICAgICogd2UgY2FsbCBhbGwgdmFsaWRhdGlvbiBtZXRob2RzIGluIG9yZGVyIHRvIGRldGVybWluZSBpZiBhbiBlbGVtZW50IGlzIHZhbGlkLlxyXG4gICAgICogRWFjaCBlbGVtZW50IHRoYXQgbmVlZHMgdGhpcyBjaGVjayBpbXBsZW1lbnRzIGl0IGl0c2VsZi5cclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcmFuZ2VVbmRlcmZsb3coZWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IG1pbiA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdtaW4nKTtcclxuICAgICAgICBpZiAoIW1pbikgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGVsZW1lbnQudmFsdWUpIDwgcGFyc2VGbG9hdChtaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGlmIHRoZSB0ZXh0IGZpZWxkIHdpdGggdHlwZSB1cmwgaGFzIGEgdmFsaWQgdXJsIGJ5IGl0cyBwYXR0ZXJuXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGlzQmFkVVJMKGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSAhPT0gJ3VybCcpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBjb25zdCBwYXR0ZXJuID0gZWxlbWVudC5wYXR0ZXJuIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdwYXR0ZXJuJyk7XHJcbiAgICAgICAgaWYgKCFwYXR0ZXJuKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50LnZhbHVlLm1hdGNoKHBhdHRlcm4pKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIHRleHQgZmllbGQgZWxlbWVudCB3aXRoIHR5cGUgZW1haWwgaXMgdmFsaWRcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgaXNCYWRFbWFpbChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgIT09ICdlbWFpbCcpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAoIWVsZW1lbnQudmFsdWUubWF0Y2goJ0AnKSkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvbiwgcmVxdWlyZS1qc2RvY1xyXG5jb25zdCBDb21wb25lbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgR0ZfQ09NUE9ORU5UX1NMT1RfVEFHX05BTUUgPSAnY29tcG9uZW50LXNsb3QnO1xyXG4gICAgY29uc3QgS0VZQ09ERVMgPSB7XHJcbiAgICAgICAgRE9XTjogNDAsXHJcbiAgICAgICAgTEVGVDogMzcsXHJcbiAgICAgICAgUklHSFQ6IDM5LFxyXG4gICAgICAgIFVQOiAzOCxcclxuICAgICAgICBIT01FOiAzNixcclxuICAgICAgICBFTkQ6IDM1LFxyXG4gICAgICAgIEVOVEVSOiAxMyxcclxuICAgICAgICBFU0NBUEU6IDI3LFxyXG4gICAgICAgIFRBQjogOSxcclxuICAgICAgICBTSElGVDogMTYsXHJcbiAgICAgICAgQ1RSTDogMTcsXHJcbiAgICAgICAgU1BBQ0U6IDMyLFxyXG4gICAgICAgIFBBR0VfVVA6IDMzLFxyXG4gICAgICAgIFBBR0VfRE9XTjogMzQsXHJcbiAgICAgICAgTEVUVEVSX0E6IDY1LFxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENsYXNzIHRoYXQgZGVmaW5lcyB0aGUgR2FtZWZhY2UgY29tcG9uZW50c1xyXG4gICAgICovXHJcbiAgICBjbGFzcyBHYW1lZmFjZUNvbXBvbmVudHMge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWpzZG9jXHJcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW1wb3J0ZWQgPSB0aGlzLmltcG9ydGVkIHx8IFtdO1xyXG4gICAgICAgICAgICB0aGlzLktFWUNPREVTID0gS0VZQ09ERVM7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVkQ29tcG9uZW50cyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5DdXN0b21FbGVtZW50VmFsaWRhdG9yID0gQ3VzdG9tRWxlbWVudFZhbGlkYXRvcjtcclxuICAgICAgICAgICAgdGhpcy5OYXRpdmVFbGVtZW50VmFsaWRhdG9yID0gTmF0aXZlRWxlbWVudFZhbGlkYXRvcjtcclxuICAgICAgICAgICAgdGhpcy5UZXh0RmllbGRWYWxpZGF0b3IgPSBUZXh0RmllbGRWYWxpZGF0b3I7XHJcbiAgICAgICAgICAgIHRoaXMuVmFsaWRhdG9yID0gVmFsaWRhdG9yO1xyXG4gICAgICAgICAgICB0aGlzLkJhc2VDb21wb25lbnQgPSBCYXNlQ29tcG9uZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ3JlYXRlIGFuZCBhZGQgYSBzY3JpcHQgdGFnIHdpdGggZ2l2ZW4gdXJsLlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuICAgICAgICAqL1xyXG4gICAgICAgIGltcG9ydFNjcmlwdCh1cmwpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcbiAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHVybCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIExvYWRzIGFuIGh0bWwgYnkgZ2l2ZW4gdXJsLlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuICAgICAgICAgKiBAcmV0dXJucyB7cHJvbWlzZX0gcmVzb2x2ZWQgd2l0aCB0aGUgaHRtbCBhcyB0ZXh0LlxyXG4gICAgICAgICovXHJcbiAgICAgICAgbG9hZEhUTUwodXJsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvYWRSZXNvdXJjZSh1cmwpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDcmVhdGVzIGEgcHJvbWlzZSB3aGljaCByZXNvbHZlcyB3aGVuIGEgY3VzdG9tIGVsZW1lbnQgd2FzIGRlZmluZWQuXHJcbiAgICAgICAgICogU2F2ZXMgdGhlIHByb21pc2UgZm9yIGVhY2ggZGVmaW5lZCBjb21wb25lbnQuXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGVsZW1lbnRcclxuICAgICAgICAgKiBAcmV0dXJucyB7cHJvbWlzZX0gLSB0aGUgcHJldmlvdXNseSBzYXZlZCBwcm9taXNlIGl0IGFueSBvciBhIG5ldyBvbmVcclxuICAgICAgICAqL1xyXG4gICAgICAgIHdoZW5EZWZpbmVkKG5hbWUpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5HVUlDb21wb25lbnRzRGVmaW5lZEVsZW1lbnRzW25hbWVdICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuR1VJQ29tcG9uZW50c0RlZmluZWRFbGVtZW50c1tuYW1lXS5wcm9taXNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkZWZpbmVkID0gd2luZG93LkdVSUNvbXBvbmVudHNEZWZpbmVkRWxlbWVudHNbbmFtZV0gPSB7fTtcclxuICAgICAgICAgICAgZGVmaW5lZC5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGVmaW5lZC5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgICAgIGRlZmluZWQucmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmluZWQucHJvbWlzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERlZmluZXMgYSBjdXN0b20gZWxlbWVudC5cclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIHRoZSBuYW1lIG9mIHRoZSBlbGVtZW50LlxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50IC0gdGhlIG9iamVjdCB3aGljaCBkZXNjcmliZXMgdGhlIGVsZW1lbnQuXHJcbiAgICAgICAgKi9cclxuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50KG5hbWUsIGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgLy8gZG9uJ3QgYXR0ZW1wdCB0byByZWdpc3RlciBjdXN0b20gZWxlbWVudCB0d2ljZVxyXG4gICAgICAgICAgICBpZiAod2luZG93LkdVSUNvbXBvbmVudHNEZWZpbmVkRWxlbWVudHNbbmFtZV0gfHwgY3VzdG9tRWxlbWVudHMuZ2V0KG5hbWUpKSByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMud2hlbkRlZmluZWQobmFtZSk7XHJcbiAgICAgICAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZShuYW1lLCBlbGVtZW50KTtcclxuICAgICAgICAgICAgd2luZG93LkdVSUNvbXBvbmVudHNEZWZpbmVkRWxlbWVudHNbbmFtZV0ucmVzb2x2ZShlbGVtZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEltcG9ydHMgYSBjb21wb25lbnQgYnkgZ2l2ZW4gdXJsLlxyXG4gICAgICAgICAqIEl0IHdpbGwgYXV0b21hdGljYWxseSB0cnkgdG8gaW1wb3J0IHN0eWxlLmNzcyBhbmQgc2NyaXB0LmpzIGlmIHRoZXNlXHJcbiAgICAgICAgICogZmlsZXMnIG5hbWVzIHdlcmUgbm90IGV4cGxpY2l0bHkgc3BlY2lmaWVkLlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSB0aGUgdXJsIG9mIHRoZSBjb21wb25lbnRcclxuICAgICAgICAqL1xyXG4gICAgICAgIGltcG9ydENvbXBvbmVudCh1cmwpIHtcclxuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW1wb3J0U2NyaXB0KHVybCArICcvc2NyaXB0LmpzJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVtb3ZlcyBiYWNrIGFuZCBmb3J3YXJkIHNsYXNoZXMgZnJvbSBzdHJpbmdcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVtb3ZlU2xhc2hlcyhwYXRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXRoLnJlcGxhY2UoL1svfFxcXFxdL2csICcnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbW92ZSBuZXcgbGluZXMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRlbXBsYXRlcyxcclxuICAgICAgICAgKiBiZWNhdXNlIHRlbXBsYXRlLmZpcnN0Q2hpbGQuY2xvbmVOb2RlIHdpbGwgY2xvbmUgYW4gZW1wdHlcclxuICAgICAgICAgKiBzdHJpbmcgYW5kIHdpbGwgcmV0dXJuIGFuIGVtcHR5IHRlbXBsYXRlLlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVOZXdMaW5lcyh0ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUucmVwbGFjZShuZXdMaW5lc1JlZ0V4cCwgJycpLnRyaW0oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbW92ZXMgdGhlIGNvcHlyaWdodCBub3RpY2UgZnJvbSB0aGUgdGVtcGxhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGVtcGxhdGVcclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgdGVtcGxhdGUgd2l0aG91dCB0aGUgY29weXJpZ2h0IG5vdGljZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgcmVtb3ZlQ29weXJpZ2h0Tm90aWNlKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKGA8IS0tQ29weXJpZ2h0IChjKSBDb2hlcmVudCBMYWJzIEFELiBBbGwgcmlnaHRzIHJlc2VydmVkLiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLiAtLT5gLCAnJykudHJpbSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVXNlZCB3aGVuIHRoZSBlbGVtZW50IGhhcyBhbHJlYWR5IGJlZW4gcmVuZGVyZWQuXHJcbiAgICAgICAgICogUmV0dXJuIHRoZSBhbHJlYWR5IHJlbmRlcmVkIHRlbXBsYXRlIGluc3RlYWQgb2ZcclxuICAgICAgICAgKiBsb2FkaW5nIGFuZCBzbG90dGluZyBpdHMgZWxlbWVudHMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBjb21wb25lbnQgLSB0aGUgY29tcG9uZW50IHRoYXQgd2FzIHJlbmRlcmVkXHJcbiAgICAgICAgICogQHJldHVybnMge1Byb21pc2U8SFRNTEVsZW1lbnQ+fSAtIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIHRoZSByZW5kZXJlZCB0ZW1wbGF0ZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgcmVzb2x2ZVdpdGhUZW1wbGF0ZShjb21wb25lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogY29tcG9uZW50LnRlbXBsYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogY29tcG9uZW50LnVybCxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFVzZXMgYW4gWE1MSHR0cFJlcXVlc3QgdG8gbG9hZCBhbiBleHRlcm5hbCBmaWxlLlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnQgLSB0aGUgdXJsIG9mIHRoZSBmaWxlLlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtwcm9taXNlfSAtIGEgcHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdpdGggdGhlIGZpbGUncyB0ZXh0IGNvbnRlbnQuXHJcbiAgICAgICAgKi9cclxuICAgICAgICBsb2FkUmVzb3VyY2UoY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChjb21wb25lbnQudGVtcGxhdGUgJiYgdHlwZW9mIGNvbXBvbmVudC50ZW1wbGF0ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQuaXNSZW5kZXJlZCkgcmV0dXJuIHRoaXMucmVzb2x2ZVdpdGhUZW1wbGF0ZShjb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnJlbW92ZUNvcHlyaWdodE5vdGljZShjb21wb25lbnQudGVtcGxhdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogdGhpcy5yZW1vdmVOZXdMaW5lcyh0ZW1wbGF0ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogY29tcG9uZW50LnVybCxcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbXBvbmVudC50ZW1wbGF0ZSA9PT0gJ29iamVjdCcgJiYgY29tcG9uZW50LmlzUmVuZGVyZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc29sdmVXaXRoVGVtcGxhdGUoY29tcG9uZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5fX29wdGltaXplKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9IHRoaXMucmVtb3ZlU2xhc2hlcyhjb21wb25lbnQudXJsKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuZmlyc3RDaGlsZDtcclxuICAgICAgICAgICAgICAgIC8vIGZhbGxiYWNrIHRvIFhIUlxyXG4gICAgICAgICAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm4gdGhpcy5yZXF1ZXN0UmVzb3VyY2UoY29tcG9uZW50LnVybCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7IHRlbXBsYXRlOiBlbGVtZW50LmlubmVySFRNTCwgdXJsOiBjb21wb25lbnQudXJsIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RSZXNvdXJjZShjb21wb25lbnQudXJsKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBFeGVjdXRlIGFuIFhNTEh0dHBSZXF1ZXN0IHRvIGxvYWQgYSByZXNvdXJjZSBieSB1cmwuXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIHRoZSBwYXRoIHRvIHRoZSByZXNvdXJjZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtwcm9taXNlfSAtIHByb21pc2Ugd2hpY2ggcmVzb2x2ZXMgd2l0aCB0aGUgbG9hZGVkIHJlc291cmNlXHJcbiAgICAgICAgKi9cclxuICAgICAgICByZXF1ZXN0UmVzb3VyY2UodXJsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25sb2FkID0gKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHsgdGVtcGxhdGU6IHJlcXVlc3QucmVzcG9uc2VUZXh0LCB1cmw6IHVybCB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSByZWplY3Q7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9wZW4oJ0dFVCcsIHVybCk7XHJcbiAgICAgICAgICAgIHJlcXVlc3Quc2VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlY3Vyc2l2ZWx5IGZpbmRzIHRoZSBzbG90IGVsZW1lbnRzIGluIGEgZ2l2ZW4gZWxlbWVudC5cclxuICAgICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBwYXJlbnQgLSB0aGUgZWxlbWVudCB3aGljaCBpcyBzZWFyY2hlZCBmb3Igc2xvdHMuXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHBhcmVudEVsTmFtZVxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSByZXN1bHQgLSBhIGtleTp2YWx1ZSBvYmplY3QgY29udGFpbmluZyB0aGUgc2xvdCBlbGVtZW50c1xyXG4gICAgICAgICAqIHVuZGVyIHRoZWlyIGRhdGEtbmFtZSBhcyB2YWx1ZTpcclxuICAgICAgICAgKiB7IDxteS1zbG90LW5hbWU+OiBIVE1MRWxlbWVudCB9XHJcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH0gcmVzdWx0XHJcbiAgICAgICAgKi9cclxuICAgICAgICBmaW5kU2xvdHMocGFyZW50LCBwYXJlbnRFbE5hbWUsIHJlc3VsdCA9IHt9KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gcGFyZW50LmNoaWxkcmVuO1xyXG4gICAgICAgICAgICBjb25zdCBsZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGRUYWdOYW1lID0gY2hpbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaGlsZFRhZ05hbWUgPT09ICdjb21wb25lbnQtc2xvdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gY2hpbGQuZGF0YXNldC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0W25hbWVdKSByZXN1bHRbbmFtZV0gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbbmFtZV0ucHVzaChjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maW5kU2xvdHMoY2hpbGQsIHBhcmVudEVsTmFtZSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGQuaGFzQXR0cmlidXRlKCdzbG90JykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbG90ID0gY2hpbGQuZ2V0QXR0cmlidXRlKCdzbG90Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHRbc2xvdF0pIHJlc3VsdFtzbG90XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtzbG90XS5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRTbG90cyhjaGlsZCwgcGFyZW50RWxOYW1lLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzY3JvbGxhYmxlIGNvbnRhaW5lciBpcyB0aGUgT05MWSBjb21wb25lbnQgdGhhdCBjYW4gaG9sZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNsb3RzIG9mIGFub3RoZXIgZWxlbWVudHM7IHdlIGFsbG93IHRoaXMgaW4gb3JkZXIgYWNoaWV2ZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGJldHRlciBpbnRlZ3JhdGlvbiBvZiB0aGUgc2Nyb2xsYmFyIGluc2lkZSBvdGhlciBjb21wb25lbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIFdlYkNvbXBvbmVudHMgYW5kIHRoZSBzdGFuZGFyZCBzbG90IGVsZW1lbnRzIGRvbid0IHN1cHBvcnRcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdWNoIGJlaGF2aW9yOyBhbiBlbGVtZW50IGhhbmRsZXMgb25seSBpdHMgb3duIHNsb3RzLiBUaGUgc2Nyb2xsYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnRhaW5lciBpcyBhbiBleGNlcHRpb24gZnJvbSB0aGlzIHJ1bGUuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoaWxkVGFnTmFtZSA9PT0gJ2dhbWVmYWNlLXNjcm9sbGFibGUtY29udGFpbmVyJyB8fFxyXG4gICAgICAgICAgICAgICAgICAgIChjaGlsZFRhZ05hbWUgIT09IEdGX0NPTVBPTkVOVF9TTE9UX1RBR19OQU1FICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEVsTmFtZSAhPT0gY2hpbGRUYWdOYW1lICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICF3aW5kb3cuR1VJQ29tcG9uZW50c0RlZmluZWRFbGVtZW50c1tjaGlsZFRhZ05hbWVdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBjaGlsZCBpcyBhbm90aGVyIG5lc3RlZCBlbGVtZW50IGRvbid0IGxvb2sgZm9yIHNsb3RzIGluIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maW5kU2xvdHMoY2hpbGQsIHBhcmVudEVsTmFtZSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdpbGwgcmVwbGFjZSB0aGUgc2xvdCBlbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBzb3VyY2VcclxuICAgICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXRcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXBsYWNlU2xvdHMoc291cmNlLCB0YXJnZXQpIHtcclxuICAgICAgICAgICAgY29uc3QgZmFrZVJvb3QgPSB0YXJnZXRbMF07XHJcbiAgICAgICAgICAgIGlmIChzb3VyY2UubGVuZ3RoICYmIGZha2VSb290LmNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoZmFrZVJvb3QuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZha2VSb290LnJlbW92ZUNoaWxkKGZha2VSb290Lmxhc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBzbG90IHNvIHRoYXQgaXQgY2FuIGJlIHJlcGxhY2VkXHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IGZha2VSb290LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChmYWtlUm9vdCk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHNvdXJjZVtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRyYW5zZmVycyB0aGUgc2xvdHRhYmxlIGVsZW1lbnRzIGludG8gdGhlaXIgc2xvdHMuXHJcbiAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gc291cmNlIC0gdGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgc2xvdHRhYmxlIGVsZW1lbnRzLlxyXG4gICAgICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCAtIHRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIHNsb3RzIGVsZW1lbnRzLlxyXG4gICAgICAgICovXHJcbiAgICAgICAgdHJhbnNmZXJDb250ZW50KHNvdXJjZSwgdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHdoaWxlICh0YXJnZXQuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRhcmdldC5jaGlsZE5vZGVzO1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZUNoaWxkKG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB3aGlsZSAoc291cmNlLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBzb3VyY2UuY2hpbGROb2RlcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1swXTtcclxuICAgICAgICAgICAgICAgIHNvdXJjZS5yZW1vdmVDaGlsZChub2RlKTtcclxuICAgICAgICAgICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVuZGVyZXMgYW4gZWxlbWVudCBvbmx5IGlmIGl0IHdhc24ndCByZW5kZXJlZCBiZWZvcmUgdGhhdFxyXG4gICAgICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIGl0IHdhcyByZW5kZXJlZCwgZmFsc2UgaWYgbm90XHJcbiAgICAgICAgKi9cclxuICAgICAgICByZW5kZXJPbmNlKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaXNSZW5kZXJlZCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuaXNSZW5kZXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgKiBSZW5kZXJzIGFuIGVsZW1lbnQncyBjb250ZW50IGludG8gaXRzIHRlbXBsYXRlLlxyXG4gICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIHRoZSBlbGVtZW50IGludG8gd2hpY2ggdG8gcmVuZGVyIHRoZSBjb250ZW50XHJcbiAgICAgICAgKi9cclxuICAgICAgICByZW5kZXIoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZVJvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgdGVtcGxhdGVSb290LmlubmVySFRNTCA9IGVsZW1lbnQudGVtcGxhdGU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRFbE5hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlU2xvdHMgPSB0aGlzLmZpbmRTbG90cyh0ZW1wbGF0ZVJvb3QsIHBhcmVudEVsTmFtZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXJTbG90cyA9IHRoaXMuZmluZFNsb3RzKGVsZW1lbnQsIHBhcmVudEVsTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvLyB1c2UgZm9yLi4ub2YgaW5zdGVhZCBvZiBmb3IuLi5pbiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXJTbG90c0tleXMgPSBPYmplY3Qua2V5cyh1c2VyU2xvdHMpO1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZVNsb3RzS2V5cyA9IE9iamVjdC5rZXlzKHRlbXBsYXRlU2xvdHMpO1xyXG5cclxuICAgICAgICAgICAgLy8gdGhlcmUncyBubyBwb2ludCBpbiBsb29waW5nIG92ZXIgdXNlclNsb3RzIGlmIHRoZXJlIGFyZW4ndFxyXG4gICAgICAgICAgICAvLyBjb3JyZXNwb25kaW5nIHRlbXBsYXRlIHNsb3RzXHJcbiAgICAgICAgICAgIGlmICh0ZW1wbGF0ZVNsb3RzS2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdXNlclNsb3Qgb2YgdXNlclNsb3RzS2V5cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdXNlclNsb3RzW3VzZXJTbG90XSB8fCAhdGVtcGxhdGVTbG90c1t1c2VyU2xvdF0pIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZVNsb3RzKHVzZXJTbG90c1t1c2VyU2xvdF0sIHRlbXBsYXRlU2xvdHNbdXNlclNsb3RdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy50cmFuc2ZlckNvbnRlbnQodGVtcGxhdGVSb290LCBlbGVtZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFVzZWQgdG8gcmVuZGVyLlxyXG4gICAgICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgLSB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGJlIHJlbmRlcmVkXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldENvbnRhaW5lclNlbGVjdG9yIC0gdGhlIHNlbGVjdG9yIG9mIHRoZSBwYXJlbnQgZWxlbWVudFxyXG4gICAgICAgICAqIEBwYXJhbSB7QXJyYXk8SFRNTEVsZW1lbnQ+fSBjaGlsZHJlbiAtIHRoZSBjaGlsZCBlbGVtZW50cyB0aGF0IG5lZWQgdG8gZ28gaW50byB0aGUgcGFyZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdHJhbnNmZXJDaGlsZHJlbihlbGVtZW50LCB0YXJnZXRDb250YWluZXJTZWxlY3RvciwgY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVSb290ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlUm9vdC5pbm5lckhUTUwgPSBlbGVtZW50LnRlbXBsYXRlO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0ZW1wbGF0ZVJvb3QucXVlcnlTZWxlY3Rvcih0YXJnZXRDb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4gY29udGFpbmVyLmFwcGVuZENoaWxkKGNoaWxkKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZmVyQ29udGVudCh0ZW1wbGF0ZVJvb3QsIGVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGVsYXkgdGhlIGV4ZWN1dGlvbiBvZiBhIGNhbGxiYWNrIGZ1bmN0aW9uIGJ5IG4gYW1vdW50IG9mIGZyYW1lcy5cclxuICAgICAgICAgKiBVc2VkIHRvIHJldHJpZXZlIHRoZSBjb21wdXRlZCBzdHlsZXMgb2YgZWxlbWVudHMuXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSB0aGUgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGV4ZWN1dGVkLlxyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCAtIHRoZSBhbW91bnQgb2YgZnJhbWVzIHRoYXQgdGhlIGNhbGxiYWNrIGV4ZWN1dGlvblxyXG4gICAgICAgICAqIHNob3VsZCBiZSBkZWxheWVkIGJ5LlxyXG4gICAgICAgICAqIEByZXR1cm5zIHthbnl9XHJcbiAgICAgICAgKi9cclxuICAgICAgICB3YWl0Rm9yRnJhbWVzKGNhbGxiYWNrID0gKCkgPT4geyB9LCBjb3VudCA9IDMpIHtcclxuICAgICAgICAgICAgaWYgKGNvdW50ID09PSAwKSByZXR1cm4gY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgY291bnQtLTtcclxuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMud2FpdEZvckZyYW1lcyhjYWxsYmFjaywgY291bnQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENoZWNrcyBpZiB0aGUgY3VycmVudCB1c2VyIGFnZW50IGlzIENvaHRtbFxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICovXHJcbiAgICAgICAgaXNCcm93c2VyR2FtZWZhY2UoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKCdDb2h0bWwnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29tcG9uZW50cyA9IG5ldyBHYW1lZmFjZUNvbXBvbmVudHMoKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENsYXNzIHRoYXQgd2lsbCBoYW5kbGUgZ2FtZWZhY2UgY29tcG9uZW50cyBzbG90IGVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgY2xhc3MgQ29tcG9uZW50U2xvdCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSByZXF1aXJlLWpzZG9jICovXHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEFwcGVuZENoaWxkID0gdGhpcy5hcHBlbmRDaGlsZDtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEluc2VydEJlZm9yZSA9IHRoaXMuaW5zZXJ0QmVmb3JlO1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsUmVwbGFjZUNoaWxkID0gdGhpcy5yZXBsYWNlQ2hpbGQ7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxSZW1vdmVDaGlsZCA9IHRoaXMucmVtb3ZlQ2hpbGQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkID0gKG5vZGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5vcmlnaW5hbEFwcGVuZENoaWxkKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwdGFjaFNsb3RDaGFuZ2UoY2hpbGQpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZDtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaW5zZXJ0QmVmb3JlID0gKG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5vcmlnaW5hbEluc2VydEJlZm9yZShuZXdOb2RlLCByZWZlcmVuY2VOb2RlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcHRhY2hTbG90Q2hhbmdlKGNoaWxkKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQ7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlcGxhY2VDaGlsZCA9IChuZXdDaGlsZCwgb2xkQ2hpbGQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VkTm9kZSA9IHRoaXMub3JpZ2luYWxSZXBsYWNlQ2hpbGQobmV3Q2hpbGQsIG9sZENoaWxkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcHRhY2hTbG90Q2hhbmdlKHJlcGxhY2VkTm9kZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VkTm9kZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGQgPSAoY2hpbGQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZWROb2RlID0gdGhpcy5vcmlnaW5hbFJlbW92ZUNoaWxkKGNoaWxkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcHRhY2hTbG90Q2hhbmdlKHJlbW92ZWROb2RlKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3ZlZE5vZGU7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkaXNwdGFjaFNsb3RDaGFuZ2UoY2hpbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnc2xvdGNoYW5nZScpLCB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMsXHJcbiAgICAgICAgICAgICAgICBjaGlsZDogY2hpbGQsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogZXNsaW50LWVuYWJsZSByZXF1aXJlLWpzZG9jICovXHJcbiAgICB9XHJcblxyXG4gICAgY29tcG9uZW50cy5kZWZpbmVDdXN0b21FbGVtZW50KEdGX0NPTVBPTkVOVF9TTE9UX1RBR19OQU1FLCBDb21wb25lbnRTbG90KTtcclxuXHJcbiAgICByZXR1cm4gY29tcG9uZW50cztcclxufTtcclxuXHJcbmV4cG9ydCB7IENvbXBvbmVudHMgfTtcclxuIiwiLy8gTW9kdWxlXG52YXIgY29kZSA9IFwiPGRpdj4gPGRpdiBjbGFzcz1cXFwiZ3VpYy1jYXJvdXNlbFxcXCI+IDxkaXYgY2xhc3M9XFxcImd1aWMtY2Fyb3VzZWwtY29udGVudC13cmFwcGVyXFxcIj4gPGNvbXBvbmVudC1zbG90IGRhdGEtbmFtZT1cXFwiY2Fyb3VzZWwtY29udGVudFxcXCI+PC9jb21wb25lbnQtc2xvdD4gPC9kaXY+IDxkaXYgY2xhc3M9XFxcImd1aWMtY2Fyb3VzZWwtYnRuLW5leHQgZ3VpYy1jYXJvdXNlbC1hcnJvdyBndWljLWNhcm91c2VsLXJpZ2h0LWFycm93XFxcIj4gPGNvbXBvbmVudC1zbG90IGRhdGEtbmFtZT1cXFwiY2Fyb3VzZWwtbmV4dFxcXCIgY2xhc3M9XFxcImd1aWMtY2Fyb3VzZWwtYXJyb3ctc2xvdFxcXCI+IDxkaXYgY2xhc3M9XFxcImd1aWMtY2Fyb3VzZWwtaW5uZXItYXJyb3cgZ3VpYy1jYXJvdXNlbC1pbm5lci1hcnJvdy1yaWdodFxcXCI+PC9kaXY+IDwvY29tcG9uZW50LXNsb3Q+IDwvZGl2PiA8ZGl2IGNsYXNzPVxcXCJndWljLWNhcm91c2VsLWJ0bi1wcmV2IGd1aWMtY2Fyb3VzZWwtYXJyb3cgZ3VpYy1jYXJvdXNlbC1sZWZ0LWFycm93XFxcIj4gPGNvbXBvbmVudC1zbG90IGRhdGEtbmFtZT1cXFwiY2Fyb3VzZWwtcHJldmlvdXNcXFwiIGNsYXNzPVxcXCJndWljLWNhcm91c2VsLWFycm93LXNsb3RcXFwiPiA8ZGl2IGNsYXNzPVxcXCJndWljLWNhcm91c2VsLWlubmVyLWFycm93IGd1aWMtY2Fyb3VzZWwtaW5uZXItYXJyb3ctbGVmdFxcXCI+PC9kaXY+IDwvY29tcG9uZW50LXNsb3Q+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz1cXFwiZ3VpYy1jYXJvdXNlbC1kb3RzXFxcIj48L2Rpdj4gPC9kaXY+XCI7XG4vLyBFeHBvcnRzXG5leHBvcnQgZGVmYXVsdCBjb2RlOyIsImltcG9ydCB7IENvbXBvbmVudHMgfSBmcm9tICdjb2hlcmVudC1nYW1lZmFjZS1jb21wb25lbnRzJztcclxuaW1wb3J0IHRlbXBsYXRlIGZyb20gJy4vdGVtcGxhdGUuaHRtbCc7XHJcblxyXG5jb25zdCBjb21wb25lbnRzID0gbmV3IENvbXBvbmVudHMoKTtcclxuY29uc3QgQmFzZUNvbXBvbmVudCA9IGNvbXBvbmVudHMuQmFzZUNvbXBvbmVudDtcclxuXHJcbmNvbnN0IENPTlRFTlRfV1JBUFBFUl9TRUxFQ1RPUiA9ICcuZ3VpYy1jYXJvdXNlbC1jb250ZW50LXdyYXBwZXInO1xyXG5jb25zdCBET1RTX0NPTlRBSU5FUl9TRUxFQ1RPUiA9ICcuZ3VpYy1jYXJvdXNlbC1kb3RzJztcclxuY29uc3QgRE9UX1NFTEVDVE9SID0gJy5ndWljLWNhcm91c2VsLWRvdCc7XHJcbmNvbnN0IENBUk9VU0VMX1NFTEVDVE9SID0gJy5ndWljLWNhcm91c2VsJztcclxuY29uc3QgTkVYVF9CVE5fU0VMRUNUT1IgPSAnLmd1aWMtY2Fyb3VzZWwtYnRuLW5leHQnO1xyXG5jb25zdCBQUkVWX0JUTl9TRUxFQ1RPUiA9ICcuZ3VpYy1jYXJvdXNlbC1idG4tcHJldic7XHJcbmNvbnN0IE5FWFRfQVJST1dfU0VMRUNUT1IgPSAnLmd1aWMtY2Fyb3VzZWwtcmlnaHQtYXJyb3cnO1xyXG5jb25zdCBQUkVWX0FSUk9XX1NFTEVDVE9SID0gJy5ndWljLWNhcm91c2VsLWxlZnQtYXJyb3cnO1xyXG5cclxuY29uc3QgRElSRUNUSU9OUyA9IHtcclxuICAgIExFRlQ6IC0xLFxyXG4gICAgUklHSFQ6IDEsXHJcbn07XHJcblxyXG4vKipcclxuICogQ2xhc3MgZGVzY3JpcHRpb25cclxuICovXHJcbmNsYXNzIENhcm91c2VsIGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XHJcbiAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1qc2RvYyAqL1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICAgICAgdGhpcy5pbml0ID0gdGhpcy5pbml0LmJpbmQodGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BhZ2VTaXplID0gMjtcclxuICAgICAgICB0aGlzLl9uYXZBcnJvd1N0ZXBTaXplID0gMTtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50SXRlbUluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLml0ZW1zRGlyZWN0aW9uID0gMTtcclxuICAgIH1cclxuXHJcbiAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1qc2RvYyAqL1xyXG4gICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgY29tcG9uZW50cy5sb2FkUmVzb3VyY2UodGhpcylcclxuICAgICAgICAgICAgLnRoZW4odGhpcy5pbml0KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlcXVpcmUtanNkb2MgKi9cclxuICAgIGluaXQoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuc2V0dXBUZW1wbGF0ZShkYXRhLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudHMucmVuZGVyT25jZSh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudFdyYXBwZXIgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoQ09OVEVOVF9XUkFQUEVSX1NFTEVDVE9SKTtcclxuICAgICAgICAgICAgY29tcG9uZW50cy53YWl0Rm9yRnJhbWVzKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pdGVtcyB8fCAhdGhpcy5pdGVtc1swXSkgcmV0dXJuIGNvbnNvbGUud2FybignTm8gaXRlbXMgd2VyZSBhZGRlZCB0byB0aGUgY2Fyb3VzZWwhJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHRoaXMuaXRlbXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1XaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtSGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBhZ2luYXRpb25Db250cm9scygpO1xyXG4gICAgICAgICAgICB0aGlzLmF0dGFjaENvbnRyb2xCdXR0b25zTGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNob3VsZFNob3dOYXZBcnJvdyhESVJFQ1RJT05TLlJJR0hULCB0aGlzLm5leHRTdGVwSW5kZXgodGhpcy5uYXZBcnJvd1N0ZXBTaXplKSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkU2hvd05hdkFycm93KERJUkVDVElPTlMuTEVGVCwgdGhpcy5wcmV2U3RlcEluZGV4KHRoaXMubmF2QXJyb3dTdGVwU2l6ZSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgcGFnZXMgb24gdGhlIGNhcm91c2VsLlxyXG4gICAgICogQ2FsY3VsYXRlZCBydW50aW1lLiBSZXR1cm5zIDAgaWYgdGhlcmUgYXJlIG5vIGl0ZW1zLlxyXG4gICAgICovXHJcbiAgICBnZXQgcGFnZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLml0ZW1zPy5sZW5ndGggLyB0aGlzLnBhZ2VTaXplKSB8fCAwO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGFsbCBjYXJvdXNlbCBpdGVtcy5cclxuICAgICAqL1xyXG4gICAgZ2V0IGl0ZW1zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3IoQ09OVEVOVF9XUkFQUEVSX1NFTEVDVE9SKS5jaGlsZHJlbjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiB0aGUgbGVuZ3RoIG9mIGFsbCBjdXJyZW50IGl0ZW1zXHJcbiAgICAgKi9cclxuICAgIGdldCBpdGVtc0xlbmd0aCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGhlIGluZGV4ZXMgb2YgYWxsIGl0ZW1zIHRoYXQgYXJlIGN1cnJlbnRseSB2aXNpYmxlIG9uIHRoZSBjYXJvdXNlbC5cclxuICAgICAqIEByZXR1cm5zIHtBcnJheTxzdHJpbmc+fVxyXG4gICAgICovXHJcbiAgICBnZXQgdmlzaWJsZUl0ZW1zSW5kZXhlcygpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogdGhpcy5wYWdlU2l6ZSB9LCAoXywgaSkgPT4gaSArIHRoaXMuY3VycmVudEl0ZW1JbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgYWxsIGN1cnJlbnRseSB2aXNpYmxlIEhUTUxFbGVtZW50cyBvbiB0aGUgY2Fyb3VzZWwuXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8SFRNTEVsZW1lbnQ+fVxyXG4gICAgICovXHJcbiAgICBnZXQgdmlzaWJsZUl0ZW1zKCkge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICByZXR1cm4gdGhpcy52aXNpYmxlSXRlbXNJbmRleGVzLm1hcChpZHggPT4gaXRlbXNbaWR4XSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGhlIGxlZnQgbmF2aWdhdGlvbiBhcnJvdyBIVE1MIEVsZW1lbnQuXHJcbiAgICAgKi9cclxuICAgIGdldCBsZWZ0QXJyb3coKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoUFJFVl9BUlJPV19TRUxFQ1RPUik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGhlIHJpZ2h0IG5hdmlnYXRpb24gYXJyb3cgSFRNTCBFbGVtZW50LlxyXG4gICAgICovXHJcbiAgICBnZXQgcmlnaHRBcnJvdygpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihORVhUX0FSUk9XX1NFTEVDVE9SKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiB0aGUgY3VycmVudCBzdGVwIHNpemUgb2YgdGhlIGNhcm91c2VsLlxyXG4gICAgICovXHJcbiAgICBnZXQgbmF2QXJyb3dTdGVwU2l6ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbmF2QXJyb3dTdGVwU2l6ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgc3RlcCBzaXplIG9mIHRoZSBjYXJvdXNlbC5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxyXG4gICAgICovXHJcbiAgICBzZXQgbmF2QXJyb3dTdGVwU2l6ZSh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX25hdkFycm93U3RlcFNpemUgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiB0aGUgY3VycmVudGx5IGFjdGl2ZSBlbGVtZW50IG9uIHRoZSBjYXJvdXNlbC5cclxuICAgICAqIFRoZSBjb3VudGluZyBzdGFydHMgZnJvbSB0aGUgZWxlbWVudCB3aGljaCBpcyBwb3NpdGlvbmVkIGF0IHRoZSBsZWZ0bW9zdCBzaWRlLlxyXG4gICAgICovXHJcbiAgICBnZXQgY3VycmVudEl0ZW1JbmRleCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudEl0ZW1JbmRleDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXHJcbiAgICAgKi9cclxuICAgIHNldCBjdXJyZW50SXRlbUluZGV4KHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudEl0ZW1JbmRleCA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHRoZSBjdXJyZW50IHBhZ2Ugc2l6ZS5cclxuICAgICAqL1xyXG4gICAgZ2V0IHBhZ2VTaXplKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYWdlU2l6ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgY3VycmVudCBwYWdlIHNpemUuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcclxuICAgICAqL1xyXG4gICAgc2V0IHBhZ2VTaXplKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fcGFnZVNpemUgPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLnJlc2l6ZSgpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlUGFnaW5hdGlvbkNvbnRyb2xzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIaWRlIG9uZSBvZiB0aGUgbmF2aWdhdGlvbiBhcnJvd3MuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGlyZWN0aW9uIC0gMSBmb3IgcmlnaHQgYXJyb3csIC0xIGZvciBsZWZ0LlxyXG4gICAgICogQHJldHVybnMge3VuZGVmaW5lZH1cclxuICAgICAqL1xyXG4gICAgaGlkZUFycm93KGRpcmVjdGlvbikge1xyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09IERJUkVDVElPTlMuUklHSFQpIHJldHVybiB0aGlzLnJpZ2h0QXJyb3cuY2xhc3NMaXN0LmFkZCgnZ3VpYy1jYXJvdXNlbC1oaWRkZW4nKTtcclxuICAgICAgICB0aGlzLmxlZnRBcnJvdy5jbGFzc0xpc3QuYWRkKCdndWljLWNhcm91c2VsLWhpZGRlbicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2hvdyBvbmUgb2YgdGhlIG5hdmlnYXRpb24gYXJyb3dzLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRpcmVjdGlvbiAtIDEgZm9yIHJpZ2h0IGFycm93LCAtMSBmb3IgbGVmdC5cclxuICAgICAqIEByZXR1cm5zIHt1bmRlZmluZWR9XHJcbiAgICAgKi9cclxuICAgIHNob3dBcnJvdyhkaXJlY3Rpb24pIHtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBESVJFQ1RJT05TLlJJR0hUKSByZXR1cm4gdGhpcy5yaWdodEFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ2d1aWMtY2Fyb3VzZWwtaGlkZGVuJyk7XHJcbiAgICAgICAgdGhpcy5sZWZ0QXJyb3cuY2xhc3NMaXN0LnJlbW92ZSgnZ3VpYy1jYXJvdXNlbC1oaWRkZW4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIHRoZSBuZXh0IGl0ZW0gd2lsbCBvdmVyZmxvdyB0aGUgY2Fyb3VzZWwncyBib3VuZGFyaWVzLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG5leHQgLSB0aGUgaW5kZXggb2YgdGhlIG5leHQgZWxlbWVudFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIG92ZXJmbG93cyhuZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXNMZW5ndGggLSBuZXh0IDwgdGhpcy5wYWdlU2l6ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgaW5kZXggb2YgdGhlIG5leHQgZWxlbWVudCBiYXNlZCBvbiB0aGUgY3VycmVudCBzdGVwIHNpemUuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RlcFNpemVcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIG5leHRTdGVwSW5kZXgoc3RlcFNpemUpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuY3VycmVudEl0ZW1JbmRleCArIHN0ZXBTaXplKSAlIHRoaXMuaXRlbXMubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBpbmRleCBvZiB0aGUgcHJldmlvdXMgZWxlbWVudCBiYXNlZCBvbiB0aGUgY3VycmVudCBzdGVwIHNpemUuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RlcFNpemVcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIHByZXZTdGVwSW5kZXgoc3RlcFNpemUpIHtcclxuICAgICAgICBjb25zdCBpdGVtc0xlbmd0aCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIHJldHVybiAodGhpcy5jdXJyZW50SXRlbUluZGV4IC0gc3RlcFNpemUgKyBpdGVtc0xlbmd0aCkgJSBpdGVtc0xlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgbmF2IGFycm93IGJhc2VkIG9uIGEgZ2l2ZW4gZGlyZWN0aW9uIHNob3VsZCBiZVxyXG4gICAgICogdmlzaWJsZSAtIGlmIG5hdmlnYXRpbmcgaW4gdGhhdCBkaXJlY3Rpb24gaXMgcG9zc2libGVcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJlY3Rpb24gLSAtMSAgZm9yIGxlZnQgYW5kIDEgZm9yIHJpZ2h0XHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbmV4dEluZGV4IC0gdGhlIGluZGV4IG9mIHRoZSBuZXh0IGl0ZW1cclxuICAgICAqIEByZXR1cm5zIHt1bmRlZmluZWR9XHJcbiAgICAgKi9cclxuICAgIHNob3VsZFNob3dOYXZBcnJvdyhkaXJlY3Rpb24sIG5leHRJbmRleCkge1xyXG4gICAgICAgIGlmICh0aGlzLm92ZXJmbG93cyhuZXh0SW5kZXgpKSByZXR1cm4gdGhpcy5oaWRlQXJyb3coZGlyZWN0aW9uKTtcclxuICAgICAgICB0aGlzLnNob3dBcnJvdyhkaXJlY3Rpb24pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGFuIGl0ZW0gdG8gdGhlIGNhcm91c2VsLlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gbm9kZVxyXG4gICAgICogQHBhcmFtIHtpbmRleH0gaW5kZXggLSB0aGUgcG9zaXRpb24gYXQgd2hpY2ggdG8gYWRkIGl0LlxyXG4gICAgICovXHJcbiAgICBhZGRJdGVtKG5vZGUsIGluZGV4KSB7XHJcbiAgICAgICAgY29uc3QgY29udGVudFdyYXBwZXIgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoQ09OVEVOVF9XUkFQUEVSX1NFTEVDVE9SKTtcclxuICAgICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCB8fCBpbmRleCA8IDApIHtcclxuICAgICAgICAgICAgY29udGVudFdyYXBwZXIuYXBwZW5kQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgcmVmZXJlbmNlTm9kZSA9IHRoaXMuaXRlbXNbaW5kZXggLSAxXTtcclxuICAgICAgICAgICAgcmVmZXJlbmNlTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLCByZWZlcmVuY2VOb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY3JlYXRlUGFnaW5hdGlvbkNvbnRyb2xzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYW4gaXRlbSBmcm9tIHRoZSBjYXJvdXNlbC5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIHRoZSBwb3NpdGlvbiBmcm9tIHdoaWNoIHRvIHJlbW92ZS5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlSXRlbShpbmRleCA9IDApIHtcclxuICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMuaXRlbXM7XHJcbiAgICAgICAgY29uc3QgaXRlbXNBcnIgPSBBcnJheS5mcm9tKGl0ZW1zKTtcclxuICAgICAgICBpdGVtc0FycltpbmRleF0ucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVQYWdpbmF0aW9uQ29udHJvbHMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1vdmUgdGhlIGNhcm91c2VsIHRvIHRoZSBwcmV2aW91cyBlbGVtZW50LlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhZ2VTaXplXHJcbiAgICAgKi9cclxuICAgIHByZXZpb3VzKHBhZ2VTaXplKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbXNMZW5ndGggPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgICBsZXQgcHJldmlvdXMgPSAodGhpcy5jdXJyZW50SXRlbUluZGV4IC0gcGFnZVNpemUgKyBpdGVtc0xlbmd0aCkgJSBpdGVtc0xlbmd0aDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMub3ZlcmZsb3dzKHByZXZpb3VzKSkgcHJldmlvdXMgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnRJdGVtSW5kZXggPSBwcmV2aW91cztcclxuICAgICAgICB0aGlzLm1vdmVUbygtdGhpcy5jdXJyZW50SXRlbUluZGV4KTtcclxuXHJcbiAgICAgICAgdGhpcy5zaG91bGRTaG93TmF2QXJyb3coRElSRUNUSU9OUy5MRUZULCB0aGlzLnByZXZTdGVwSW5kZXgodGhpcy5uYXZBcnJvd1N0ZXBTaXplKSk7XHJcbiAgICAgICAgdGhpcy5zaG91bGRTaG93TmF2QXJyb3coRElSRUNUSU9OUy5SSUdIVCwgdGhpcy5uZXh0U3RlcEluZGV4KHRoaXMubmF2QXJyb3dTdGVwU2l6ZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTW92ZSB0aGUgY2Fyb3VzZWwgdG8gdGhlIG5leHQgZWxlbWVudC5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwYWdlU2l6ZVxyXG4gICAgICovXHJcbiAgICBuZXh0KHBhZ2VTaXplKSB7XHJcbiAgICAgICAgY29uc3QgbmV4dCA9ICh0aGlzLmN1cnJlbnRJdGVtSW5kZXggKyBwYWdlU2l6ZSkgJSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLm92ZXJmbG93cyhuZXh0KSkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtSW5kZXggPSBuZXh0O1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbygtdGhpcy5jdXJyZW50SXRlbUluZGV4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvdWxkU2hvd05hdkFycm93KERJUkVDVElPTlMuTEVGVCwgdGhpcy5wcmV2U3RlcEluZGV4KHRoaXMubmF2QXJyb3dTdGVwU2l6ZSkpO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkU2hvd05hdkFycm93KERJUkVDVElPTlMuUklHSFQsIHRoaXMubmV4dFN0ZXBJbmRleCh0aGlzLm5hdkFycm93U3RlcFNpemUpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1vdmUgdGhlIGNhcm91c2VsIHRvIGEgc3BlY2lmaWMgZWxlbWVudCBiYXNlZCBvbiBnaXZlbiBpbmRleC5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxyXG4gICAgICovXHJcbiAgICBtb3ZlVG8oaW5kZXgpIHtcclxuICAgICAgICB0aGlzLmNvbnRlbnRXcmFwcGVyLnN0eWxlLmxlZnQgPSBgJHtpbmRleCAqIHRoaXMuaXRlbVdpZHRofXB4YDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSB0aGUgcGFnaW5hdGlvbiBkb3RzLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhZ2VcclxuICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH1cclxuICAgICAqL1xyXG4gICAgY3JlYXRlRG90KHBhZ2UpIHtcclxuICAgICAgICBjb25zdCBkb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBkb3QuY2xhc3NMaXN0LmFkZCgnZ3VpYy1jYXJvdXNlbC1kb3QnKTtcclxuICAgICAgICBkb3QuZGF0YXNldC5wYWdlID0gcGFnZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRvdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSB0aGUgcGFnaW5hdGlvbiBjb250cm9scyAtIHRoZSBkb3RzIGFuZCBhdHRhY2ggY2xpY2sgZXZlbnQgaGFuZGxlcnNcclxuICAgICAqL1xyXG4gICAgY3JlYXRlUGFnaW5hdGlvbkNvbnRyb2xzKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMucXVlcnlTZWxlY3RvcihET1RTX0NPTlRBSU5FUl9TRUxFQ1RPUik7XHJcbiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGFnZXM7IGkrKykge1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVEb3QoaSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZG90cyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKERPVF9TRUxFQ1RPUik7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZG90cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBkb3RzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB0aGlzLm9uQ2xpY2tPbk5hdkRvdChlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gYSBuYXZpZ2F0aW9uIGRvdCBpcyBjbGlja2VkLlxyXG4gICAgICogTmF2aWdhdGVzIHRvIHRoZSBzcGVjaWZpYyBwYWdlLlxyXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxyXG4gICAgICovXHJcbiAgICBvbkNsaWNrT25OYXZEb3QoZSkge1xyXG4gICAgICAgIGNvbnN0IHBhZ2UgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5wYWdlO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEl0ZW1JbmRleCA9IChOdW1iZXIocGFnZSkgKiB0aGlzLnBhZ2VTaXplKTtcclxuXHJcbiAgICAgICAgdGhpcy5tb3ZlVG8oLXRoaXMuY3VycmVudEl0ZW1JbmRleCk7XHJcbiAgICAgICAgdGhpcy5zaG91bGRTaG93TmF2QXJyb3coRElSRUNUSU9OUy5SSUdIVCwgdGhpcy5uZXh0U3RlcEluZGV4KHRoaXMubmF2QXJyb3dTdGVwU2l6ZSkpO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkU2hvd05hdkFycm93KERJUkVDVElPTlMuTEVGVCwgdGhpcy5wcmV2U3RlcEluZGV4KHRoaXMubmF2QXJyb3dTdGVwU2l6ZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzaXplIHRoZSBjYXJvdXNlbCBiYXNlZCBvbiB0aGUgc2l6ZSBvZiB0aGUgZWxlbWVudHMuXHJcbiAgICAgKi9cclxuICAgIHJlc2l6ZSgpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoQ0FST1VTRUxfU0VMRUNUT1IpLnN0eWxlLndpZHRoID0gdGhpcy5wYWdlU2l6ZSAqIHRoaXMuaXRlbVdpZHRoICsgJ3B4JztcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoQ0FST1VTRUxfU0VMRUNUT1IpLnN0eWxlLmhlaWdodCA9IHRoaXMuaXRlbUhlaWdodCArICdweCc7XHJcbiAgICAgICAgdGhpcy5zdHlsZS53aWR0aCA9IHRoaXMucGFnZVNpemUgKiB0aGlzLml0ZW1XaWR0aCArICdweCc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRhY2ggdGhlIGV2ZW50IGhhbmRsZXJzIG9mIHRoZSBjb250cm9sIGJ1dHRvbnMgLSBuZXh0LCBwcmV2aW91c1xyXG4gICAgICovXHJcbiAgICBhdHRhY2hDb250cm9sQnV0dG9uc0xpc3RlbmVycygpIHtcclxuICAgICAgICBjb25zdCBzaW5nbGVOZXh0QnV0dG9uID0gdGhpcy5xdWVyeVNlbGVjdG9yKE5FWFRfQlROX1NFTEVDVE9SKTtcclxuICAgICAgICBjb25zdCBzaW5nbGVQcmV2aW91c0J1dHRvbiA9IHRoaXMucXVlcnlTZWxlY3RvcihQUkVWX0JUTl9TRUxFQ1RPUik7XHJcblxyXG4gICAgICAgIHNpbmdsZU5leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfID0+IHRoaXMubmV4dCgxKSk7XHJcbiAgICAgICAgc2luZ2xlUHJldmlvdXNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfID0+IHRoaXMucHJldmlvdXMoMSkpO1xyXG4gICAgfVxyXG59XHJcbmNvbXBvbmVudHMuZGVmaW5lQ3VzdG9tRWxlbWVudCgnZ2FtZWZhY2UtY2Fyb3VzZWwnLCBDYXJvdXNlbCk7XHJcbmV4cG9ydCBkZWZhdWx0IENhcm91c2VsO1xyXG4iXSwibmFtZXMiOlsibmV3TGluZXNSZWdFeHAiLCJSZWdFeHAiLCJOQVRJVkVfVEVYVF9GSUVMRF9FTEVNRU5UUyIsImlzTmF0aXZlVGV4dEZpZWxkIiwiZWxlbWVudCIsImluZGV4T2YiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJ3aW5kb3ciLCJHVUlDb21wb25lbnRzRGVmaW5lZEVsZW1lbnRzIiwiQmFzZUNvbXBvbmVudCIsIkhUTUxFbGVtZW50IiwiaW5zdGFuY2VUeXBlIiwic2V0dXBUZW1wbGF0ZSIsImRhdGEiLCJjYWxsYmFjayIsInRoaXMiLCJpc0Nvbm5lY3RlZCIsImNvbnNvbGUiLCJsb2ciLCJ0ZW1wbGF0ZSIsImlzU3RhdGVQcm9wVmFsaWQiLCJuYW1lIiwidmFsdWUiLCJzY2hlbWFQcm9wZXJ0eSIsInN0YXRlU2NoZW1hIiwiZXJyb3IiLCJ0eXBlIiwiaW5jbHVkZXMiLCJBcnJheSIsImlzQXJyYXkiLCJqb2luIiwiVmFsaWRhdG9yIiwiaXNGb3JtRWxlbWVudCIsInBhcmVudEVsZW1lbnQiLCJ0b29Mb25nIiwidG9vU2hvcnQiLCJyYW5nZU92ZXJmbG93IiwicmFuZ2VVbmRlcmZsb3ciLCJ2YWx1ZU1pc3NpbmciLCJoYXNBdHRyaWJ1dGUiLCJuYW1lTWlzc2luZyIsImdldEF0dHJpYnV0ZSIsImlzUmVxdWlyZWQiLCJjdXN0b21FcnJvciIsIndpbGxTZXJpYWxpemUiLCJpc0JhZFVSTCIsImlzQmFkRW1haWwiLCJOYXRpdmVFbGVtZW50VmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJUZXh0RmllbGRWYWxpZGF0b3IiLCJDdXN0b21FbGVtZW50VmFsaWRhdG9yIiwibWF4TGVuZ3RoIiwibGVuZ3RoIiwicGFyc2VGbG9hdCIsIm1pbkxlbmd0aCIsIm1heCIsIm1pbiIsInBhdHRlcm4iLCJtYXRjaCIsImNvbXBvbmVudHMiLCJHRl9DT01QT05FTlRfU0xPVF9UQUdfTkFNRSIsIktFWUNPREVTIiwiRE9XTiIsIkxFRlQiLCJSSUdIVCIsIlVQIiwiSE9NRSIsIkVORCIsIkVOVEVSIiwiRVNDQVBFIiwiVEFCIiwiU0hJRlQiLCJDVFJMIiwiU1BBQ0UiLCJQQUdFX1VQIiwiUEFHRV9ET1dOIiwiTEVUVEVSX0EiLCJpbXBvcnRlZCIsImNhY2hlZENvbXBvbmVudHMiLCJpbXBvcnRTY3JpcHQiLCJ1cmwiLCJzY3JpcHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJsb2FkSFRNTCIsImxvYWRSZXNvdXJjZSIsInRoZW4iLCJyZXN1bHQiLCJ3aGVuRGVmaW5lZCIsInVuZGVmaW5lZCIsInByb21pc2UiLCJkZWZpbmVkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJkZWZpbmVDdXN0b21FbGVtZW50IiwiY3VzdG9tRWxlbWVudHMiLCJnZXQiLCJkZWZpbmUiLCJpbXBvcnRDb21wb25lbnQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyZW1vdmVTbGFzaGVzIiwicGF0aCIsInJlcGxhY2UiLCJyZW1vdmVOZXdMaW5lcyIsInRyaW0iLCJyZW1vdmVDb3B5cmlnaHROb3RpY2UiLCJyZXNvbHZlV2l0aFRlbXBsYXRlIiwiY29tcG9uZW50IiwiaXNSZW5kZXJlZCIsIl9fb3B0aW1pemUiLCJpZCIsImdldEVsZW1lbnRCeUlkIiwiZmlyc3RDaGlsZCIsImlubmVySFRNTCIsInJlcXVlc3RSZXNvdXJjZSIsInJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsIm9ubG9hZCIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0Iiwib25lcnJvciIsIm9wZW4iLCJzZW5kIiwiZmluZFNsb3RzIiwicGFyZW50IiwicGFyZW50RWxOYW1lIiwiY2hpbGRyZW4iLCJpIiwiY2hpbGQiLCJjaGlsZFRhZ05hbWUiLCJkYXRhc2V0IiwicHVzaCIsInNsb3QiLCJyZXBsYWNlU2xvdHMiLCJzb3VyY2UiLCJ0YXJnZXQiLCJmYWtlUm9vdCIsImNoaWxkTm9kZXMiLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsInBhcmVudE5vZGUiLCJ0cmFuc2ZlckNvbnRlbnQiLCJub2RlcyIsIm5vZGUiLCJyZW5kZXJPbmNlIiwicmVuZGVyIiwidGVtcGxhdGVSb290IiwidGVtcGxhdGVTbG90cyIsInVzZXJTbG90cyIsInVzZXJTbG90c0tleXMiLCJPYmplY3QiLCJrZXlzIiwidXNlclNsb3QiLCJ0cmFuc2ZlckNoaWxkcmVuIiwidGFyZ2V0Q29udGFpbmVyU2VsZWN0b3IiLCJjb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiZm9yRWFjaCIsIndhaXRGb3JGcmFtZXMiLCJjb3VudCIsImlzQnJvd3NlckdhbWVmYWNlIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiQ29tcG9uZW50U2xvdCIsInN1cGVyIiwib3JpZ2luYWxBcHBlbmRDaGlsZCIsIm9yaWdpbmFsSW5zZXJ0QmVmb3JlIiwiaW5zZXJ0QmVmb3JlIiwib3JpZ2luYWxSZXBsYWNlQ2hpbGQiLCJyZXBsYWNlQ2hpbGQiLCJvcmlnaW5hbFJlbW92ZUNoaWxkIiwiZGlzcHRhY2hTbG90Q2hhbmdlIiwibmV3Tm9kZSIsInJlZmVyZW5jZU5vZGUiLCJuZXdDaGlsZCIsIm9sZENoaWxkIiwicmVwbGFjZWROb2RlIiwicmVtb3ZlZE5vZGUiLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJDT05URU5UX1dSQVBQRVJfU0VMRUNUT1IiLCJDQVJPVVNFTF9TRUxFQ1RPUiIsImluaXQiLCJiaW5kIiwiX3BhZ2VTaXplIiwiX25hdkFycm93U3RlcFNpemUiLCJjdXJyZW50SXRlbUluZGV4IiwiaXRlbXNEaXJlY3Rpb24iLCJjb25uZWN0ZWRDYWxsYmFjayIsImNhdGNoIiwiZXJyIiwiY29udGVudFdyYXBwZXIiLCJpdGVtcyIsIndhcm4iLCJ3aWR0aCIsImhlaWdodCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIml0ZW1XaWR0aCIsIml0ZW1IZWlnaHQiLCJyZXNpemUiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJjcmVhdGVQYWdpbmF0aW9uQ29udHJvbHMiLCJhdHRhY2hDb250cm9sQnV0dG9uc0xpc3RlbmVycyIsInNob3VsZFNob3dOYXZBcnJvdyIsIm5leHRTdGVwSW5kZXgiLCJuYXZBcnJvd1N0ZXBTaXplIiwicHJldlN0ZXBJbmRleCIsInBhZ2VzIiwicGFnZVNpemUiLCJpdGVtc0xlbmd0aCIsInZpc2libGVJdGVtc0luZGV4ZXMiLCJmcm9tIiwiXyIsInZpc2libGVJdGVtcyIsIm1hcCIsImlkeCIsImxlZnRBcnJvdyIsInJpZ2h0QXJyb3ciLCJfY3VycmVudEl0ZW1JbmRleCIsImhpZGVBcnJvdyIsImRpcmVjdGlvbiIsImNsYXNzTGlzdCIsImFkZCIsInNob3dBcnJvdyIsInJlbW92ZSIsIm92ZXJmbG93cyIsIm5leHQiLCJzdGVwU2l6ZSIsIm5leHRJbmRleCIsImFkZEl0ZW0iLCJpbmRleCIsInJlbW92ZUl0ZW0iLCJwcmV2aW91cyIsIm1vdmVUbyIsImxlZnQiLCJjcmVhdGVEb3QiLCJwYWdlIiwiZG90IiwiZG90cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsIm9uQ2xpY2tPbk5hdkRvdCIsImN1cnJlbnRUYXJnZXQiLCJOdW1iZXIiLCJzaW5nbGVOZXh0QnV0dG9uIiwic2luZ2xlUHJldmlvdXNCdXR0b24iXSwic291cmNlUm9vdCI6IiJ9